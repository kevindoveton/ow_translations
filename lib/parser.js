"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.TranslationRowType = void 0;

var _template = require("./template");

var _Types = require("./Types");

var fs = require('fs');

/**
 * Parser pulls down the translations from Google sheets, and puts them
 * in the right fields.
 */
var request = require('request-promise-native');

var TranslationRowType;
exports.TranslationRowType = TranslationRowType;

(function (TranslationRowType) {
  TranslationRowType["string"] = "string";
  TranslationRowType["function"] = "function";
})(TranslationRowType || (exports.TranslationRowType = TranslationRowType = {}));

function writeFile(path, contents) {
  return new Promise(function (resolve, reject) {
    fs.writeFile(path, contents, function (err) {
      if (err) {
        return reject(err);
      }

      resolve();
    });
  });
}

function sanitize(input) {
  // return input.replace('"', "'");
  return input.replace(/"/g, "'");
}

function getSheetAsJson(sheetId) {
  //https://docs.google.com/spreadsheets/d/e/2PACX-1vSHp6u_WXM18NB9RqPfiaKugHdT_zhHP5NQlZYStzRJfnwFJPlfwTSYtAGJvP1axvhZ8WifYJcE8RAJ/pubhtml
  var url = "https://spreadsheets.google.com/feeds/list/".concat(sheetId, "/default/public/values?alt=json;");
  var options = {
    method: 'GET',
    url: url,
    qs: {
      alt: 'json'
    },
    headers: {
      'Cache-Control': 'no-cache'
    },
    json: true
  };
  return request(options);
}

function sheetsResponseToRows(response) {
  var perRowTranslations = [];
  response.feed.entry.forEach(function (r) {
    var row = {
      id: r.title.$t,
      notes: r.gsx$notes.$t,
      type: r.gsx$type.$t,
      en_AU: r.gsx$enau.$t,
      en_US: r.gsx$enus.$t,
      guj_IN: r.gsx$gujin.$t,
      hi_IN: r.gsx$hiin.$t,
      test_UPPER: r.gsx$testupper.$t,
      fr_FR: r.gsx$frfr.$t,
      es_ES: sanitize(r.gsx$eses.$t)
    };
    perRowTranslations.push(row);
  });
  return perRowTranslations;
}

function sheetsResponseToRowsGGMN(response) {
  var perRowTranslations = [];
  response.feed.entry.forEach(function (r) {
    var row = {
      id: r.title.$t,
      notes: r.gsx$notes.$t,
      type: r.gsx$type.$t,
      en_AU: r.gsx$enau.$t,
      fr_FR: r.gsx$frfr.$t,
      es_ES: sanitize(r.gsx$eses.$t)
    };
    perRowTranslations.push(row);
  });
  return perRowTranslations;
}

function run() {
  getSheetAsJson("102zLqEWj4xlqqNgVUFCiMLqdcvaLY6GntS1xmlHdAE8").then(function (response) {
    var perRowTranslations = sheetsResponseToRows(response); //Now that we have the rows, write the files!

    var en_AU = {};
    var en_US = {};
    var guj_IN = {};
    var hi_IN = {};
    var fr_FR = {};
    var es_ES = {};
    var test_UPPER = {};
    perRowTranslations.forEach(function (row) {
      return en_AU[row.id] = [row.en_AU, row.type];
    });
    perRowTranslations.forEach(function (row) {
      return en_US[row.id] = [row.en_US, row.type];
    });
    perRowTranslations.forEach(function (row) {
      return guj_IN[row.id] = [row.guj_IN, row.type];
    });
    perRowTranslations.forEach(function (row) {
      return hi_IN[row.id] = [row.hi_IN, row.type];
    });
    perRowTranslations.forEach(function (row) {
      return fr_FR[row.id] = [row.fr_FR, row.type];
    });
    perRowTranslations.forEach(function (row) {
      return es_ES[row.id] = [row.es_ES, row.type];
    });
    perRowTranslations.forEach(function (row) {
      return test_UPPER[row.id] = [row.test_UPPER, row.type];
    });
    var en_AU_file = (0, _template.fileForTranslations)(_Types.TranslationEnum.en_AU, en_AU);
    var en_US_file = (0, _template.fileForTranslations)(_Types.TranslationEnum.en_US, en_US);
    var uj_IN_file = (0, _template.fileForTranslations)(_Types.TranslationEnum.guj_IN, guj_IN);
    var hi_IN_file = (0, _template.fileForTranslations)(_Types.TranslationEnum.hi_IN, hi_IN);
    var test_UPPER_file = (0, _template.fileForTranslations)(_Types.TranslationEnum.test_UPPER, test_UPPER);
    var fr_FR_file = (0, _template.fileForTranslations)(_Types.TranslationEnum.fr_FR, fr_FR);
    var es_ES_file = (0, _template.fileForTranslations)(_Types.TranslationEnum.es_ES, es_ES);
    return Promise.all([writeFile('./src/common/en_AU.ts', en_AU_file), writeFile('./src/common/en_US.ts', en_US_file), writeFile('./src/common/guj_IN.ts', uj_IN_file), writeFile('./src/common/hi_IN.ts', hi_IN_file), writeFile('./src/common/test_UPPER.ts', test_UPPER_file), writeFile('./src/common/fr_FR.ts', fr_FR_file), writeFile('./src/common/es_ES.ts', es_ES_file)]).catch(function (err) {
      return console.error(err);
    });
  }).catch(function (err) {
    return console.error(err);
  });
}

function getOverrides(sheetId, orgId) {
  return getSheetAsJson(sheetId).then(function (response) {
    var perRowTranslations = sheetsResponseToRowsGGMN(response).filter(function (r) {
      return r.notes.toLowerCase() === 'override';
    });
    console.log("Found ".concat(perRowTranslations.length, " overrides for org: ").concat(orgId)); //TODO: generalize to other orgs, for now GGMN is fine
    //Now that we have the rows, write the files!

    var en_AU = {};
    var fr_FR = {};
    var es_ES = {};
    perRowTranslations.forEach(function (row) {
      return en_AU[row.id] = [row.en_AU, row.type];
    });
    perRowTranslations.forEach(function (row) {
      return fr_FR[row.id] = [row.fr_FR, row.type];
    });
    perRowTranslations.forEach(function (row) {
      return es_ES[row.id] = [row.es_ES, row.type];
    });
    var en_AU_file = (0, _template.fileForOverrides)(orgId, _Types.TranslationEnum.en_AU, en_AU);
    var fr_FR_file = (0, _template.fileForOverrides)(orgId, _Types.TranslationEnum.fr_FR, fr_FR);
    var es_ES_file = (0, _template.fileForOverrides)(orgId, _Types.TranslationEnum.es_ES, es_ES);
    return Promise.all([writeFile("./src/".concat(orgId, "/en_AU.ts"), en_AU_file), writeFile("./src/".concat(orgId, "/fr_FR.ts"), fr_FR_file), writeFile("./src/".concat(orgId, "/es_ES.ts"), es_ES_file)]).catch(function (err) {
      return console.error(err);
    });
  });
} // run();
//https://docs.google.com/spreadsheets/d/e/2PACX-1vRiCJNicJ6lrCZZF2OjvuNlY8SwbFFuguQWEGMn-QoizWlYtOFaZrorzJTYEYnxkU9SFybgC3w4PAaO/pubhtml


getOverrides('11JUqNJ-gScZ3scUe1bi7XMWDJgniwS7ZY4Guxv5AJtE', 'ggmn');
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9wYXJzZXIudHMiXSwibmFtZXMiOlsiZnMiLCJyZXF1aXJlIiwicmVxdWVzdCIsIlRyYW5zbGF0aW9uUm93VHlwZSIsIndyaXRlRmlsZSIsInBhdGgiLCJjb250ZW50cyIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZXJyIiwic2FuaXRpemUiLCJpbnB1dCIsInJlcGxhY2UiLCJnZXRTaGVldEFzSnNvbiIsInNoZWV0SWQiLCJ1cmwiLCJvcHRpb25zIiwibWV0aG9kIiwicXMiLCJhbHQiLCJoZWFkZXJzIiwianNvbiIsInNoZWV0c1Jlc3BvbnNlVG9Sb3dzIiwicmVzcG9uc2UiLCJwZXJSb3dUcmFuc2xhdGlvbnMiLCJmZWVkIiwiZW50cnkiLCJmb3JFYWNoIiwiciIsInJvdyIsImlkIiwidGl0bGUiLCIkdCIsIm5vdGVzIiwiZ3N4JG5vdGVzIiwidHlwZSIsImdzeCR0eXBlIiwiZW5fQVUiLCJnc3gkZW5hdSIsImVuX1VTIiwiZ3N4JGVudXMiLCJndWpfSU4iLCJnc3gkZ3VqaW4iLCJoaV9JTiIsImdzeCRoaWluIiwidGVzdF9VUFBFUiIsImdzeCR0ZXN0dXBwZXIiLCJmcl9GUiIsImdzeCRmcmZyIiwiZXNfRVMiLCJnc3gkZXNlcyIsInB1c2giLCJzaGVldHNSZXNwb25zZVRvUm93c0dHTU4iLCJydW4iLCJ0aGVuIiwiZW5fQVVfZmlsZSIsIlRyYW5zbGF0aW9uRW51bSIsImVuX1VTX2ZpbGUiLCJ1al9JTl9maWxlIiwiaGlfSU5fZmlsZSIsInRlc3RfVVBQRVJfZmlsZSIsImZyX0ZSX2ZpbGUiLCJlc19FU19maWxlIiwiYWxsIiwiY2F0Y2giLCJjb25zb2xlIiwiZXJyb3IiLCJnZXRPdmVycmlkZXMiLCJvcmdJZCIsImZpbHRlciIsInRvTG93ZXJDYXNlIiwibG9nIiwibGVuZ3RoIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQ0E7O0FBQ0E7O0FBRkEsSUFBTUEsRUFBRSxHQUFHQyxPQUFPLENBQUMsSUFBRCxDQUFsQjs7QUFJQTs7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LENBQXBCO0FBQUEsS0FBOUI7QUFDQVgsSUFBQUEsa0JBQWtCLENBQUNHLE9BQW5CLENBQTJCLFVBQUFFLEdBQUc7QUFBQSxhQUFJb0IsS0FBSyxDQUFDcEIsR0FBRyxDQUFDQyxFQUFMLENBQUwsR0FBZ0IsQ0FBQ0QsR0FBRyxDQUFDb0IsS0FBTCxFQUFZcEIsR0FBRyxDQUFDTSxJQUFoQixDQUFwQjtBQUFBLEtBQTlCO0FBRUEsUUFBTW9CLFVBQVUsR0FBRyxnQ0FBaUJhLEtBQWpCLEVBQXdCWix1QkFBZ0JuQixLQUF4QyxFQUErQ0EsS0FBL0MsQ0FBbkI7QUFDQSxRQUFNd0IsVUFBVSxHQUFHLGdDQUFpQk8sS0FBakIsRUFBd0JaLHVCQUFnQlQsS0FBeEMsRUFBK0NBLEtBQS9DLENBQW5CO0FBQ0EsUUFBTWUsVUFBVSxHQUFHLGdDQUFpQk0sS0FBakIsRUFBd0JaLHVCQUFnQlAsS0FBeEMsRUFBK0NBLEtBQS9DLENBQW5CO0FBRUEsV0FBTzNDLE9BQU8sQ0FBQ3lELEdBQVIsQ0FBWSxDQUNqQjVELFNBQVMsaUJBQVVpRSxLQUFWLGdCQUE0QmIsVUFBNUIsQ0FEUSxFQUVqQnBELFNBQVMsaUJBQVVpRSxLQUFWLGdCQUE0QlAsVUFBNUIsQ0FGUSxFQUdqQjFELFNBQVMsaUJBQVVpRSxLQUFWLGdCQUE0Qk4sVUFBNUIsQ0FIUSxDQUFaLEVBSUpFLEtBSkksQ0FJRSxVQUFBdkQsR0FBRztBQUFBLGFBQUl3RCxPQUFPLENBQUNDLEtBQVIsQ0FBY3pELEdBQWQsQ0FBSjtBQUFBLEtBSkwsQ0FBUDtBQUtELEdBeEJNLENBQVA7QUEyQkQsQyxDQUVEO0FBQ0E7OztBQUNBMEQsWUFBWSxDQUFDLDhDQUFELEVBQWlELE1BQWpELENBQVoiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5pbXBvcnQgeyBmaWxlRm9yVHJhbnNsYXRpb25zLCBmaWxlRm9yT3ZlcnJpZGVzIH0gZnJvbSBcIi4vdGVtcGxhdGVcIjtcbmltcG9ydCB7IFRyYW5zbGF0aW9uRW51bSB9IGZyb20gXCIuL1R5cGVzXCI7XG5cbi8qKlxuICogUGFyc2VyIHB1bGxzIGRvd24gdGhlIHRyYW5zbGF0aW9ucyBmcm9tIEdvb2dsZSBzaGVldHMsIGFuZCBwdXRzIHRoZW1cbiAqIGluIHRoZSByaWdodCBmaWVsZHMuXG4gKi9cblxuY29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3JlcXVlc3QtcHJvbWlzZS1uYXRpdmUnKTtcblxuZXhwb3J0IHR5cGUgU2hlZXRzUmVzcG9uc2UgPSB7XG4gIHZlcnNpb246IHN0cmluZyxcbiAgZW5jb2Rpbmc6IHN0cmluZyxcbiAgZmVlZDogU2hlZXRzRmVlZCxcbn1cblxuZXhwb3J0IHR5cGUgU2hlZXRzRmVlZCA9IHtcbiAgdGl0bGU6IHN0cmluZyxcbiAgdXBkYXRlZDogc3RyaW5nLFxuICBlbnRyeTogU2hlZXRzUm93W10sXG59XG5cbmV4cG9ydCB0eXBlIFNoZWV0c1JvdyA9IHtcbiAgdGl0bGU6IHtcbiAgICB0eXBlOiBzdHJpbmcsXG4gICAgXCIkdFwiOiBzdHJpbmcsXG4gIH0sXG4gIGNvbnRlbnQ6IHtcbiAgICB0eXBlOiBzdHJpbmcsXG4gICAgXCIkdFwiOiBzdHJpbmcsXG4gIH0sXG4gIGdzeCR0eXBlOiB7XG4gICAgJHQ6IFRyYW5zbGF0aW9uUm93VHlwZSxcbiAgfVxuICBnc3gkaWQ6IHtcbiAgICAkdDogc3RyaW5nLFxuICB9XG4gIGdzeCRub3Rlczoge1xuICAgICR0OiBzdHJpbmcsXG4gIH1cbiAgZ3N4JGVuYXU6IHtcbiAgICAkdDogc3RyaW5nLFxuICB9LFxuICBnc3gkZW51czoge1xuICAgICR0OiBzdHJpbmcsXG4gIH0sXG4gIGdzeCRndWppbjoge1xuICAgICR0OiBzdHJpbmcsXG4gIH0sXG4gIGdzeCRoaWluOiB7XG4gICAgJHQ6IHN0cmluZyxcbiAgfSxcbiAgZ3N4JHRlc3R1cHBlcjoge1xuICAgICR0OiBzdHJpbmcsXG4gIH0sXG4gIGdzeCRmcmZyOiB7XG4gICAgJHQ6IHN0cmluZyxcbiAgfSxcbiAgZ3N4JGVzZXM6IHtcbiAgICAkdDogc3RyaW5nLFxuICB9LFxufVxuXG5leHBvcnQgZW51bSBUcmFuc2xhdGlvblJvd1R5cGUge1xuICBzdHJpbmcgPSAnc3RyaW5nJyxcbiAgZnVuY3Rpb24gPSAnZnVuY3Rpb24nLFxufVxuXG5leHBvcnQgdHlwZSBUcmFuc2xhdGlvblJvdyA9IHtcbiAgaWQ6IHN0cmluZyxcbiAgdHlwZTogVHJhbnNsYXRpb25Sb3dUeXBlLFxuICBub3Rlczogc3RyaW5nLFxuICBlbl9BVTogc3RyaW5nLFxuICBlbl9VUzogc3RyaW5nLFxuICBndWpfSU46IHN0cmluZyxcbiAgaGlfSU46IHN0cmluZyxcbiAgdGVzdF9VUFBFUjogc3RyaW5nLFxuICBmcl9GUjogc3RyaW5nLFxuICBlc19FUzogc3RyaW5nLFxufVxuXG5leHBvcnQgdHlwZSBHR01OVHJhbnNsYXRpb25Sb3cgPSB7XG4gIGlkOiBzdHJpbmcsXG4gIHR5cGU6IFRyYW5zbGF0aW9uUm93VHlwZSxcbiAgbm90ZXM6IHN0cmluZyxcbiAgZW5fQVU6IHN0cmluZyxcbiAgZnJfRlI6IHN0cmluZyxcbiAgZXNfRVM6IHN0cmluZyxcbn1cblxuZXhwb3J0IHR5cGUgVHJhbnNsYXRpb25Db2x1bW4gPSB7XG4gIFtpbmRleDogc3RyaW5nXTogW3N0cmluZywgVHJhbnNsYXRpb25Sb3dUeXBlXVxufVxuXG5cbmZ1bmN0aW9uIHdyaXRlRmlsZShwYXRoOnN0cmluZywgY29udGVudHM6c3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgZnMud3JpdGVGaWxlKHBhdGgsIGNvbnRlbnRzLCAoZXJyOiBhbnkpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmV0dXJuIHJlamVjdChlcnIpO1xuICAgICAgfVxuXG4gICAgICByZXNvbHZlKCk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBzYW5pdGl6ZShpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgLy8gcmV0dXJuIGlucHV0LnJlcGxhY2UoJ1wiJywgXCInXCIpO1xuICByZXR1cm4gaW5wdXQucmVwbGFjZSgvXCIvZywgXCInXCIpO1xufVxuXG5mdW5jdGlvbiBnZXRTaGVldEFzSnNvbihzaGVldElkOiBzdHJpbmcpOiBQcm9taXNlPFNoZWV0c1Jlc3BvbnNlPiB7XG4gIC8vaHR0cHM6Ly9kb2NzLmdvb2dsZS5jb20vc3ByZWFkc2hlZXRzL2QvZS8yUEFDWC0xdlNIcDZ1X1dYTTE4TkI5UnFQZmlhS3VnSGRUX3poSFA1TlFsWllTdHpSSmZud0ZKUGxmd1RTWXRBR0p2UDFheHZoWjhXaWZZSmNFOFJBSi9wdWJodG1sXG4gIGNvbnN0IHVybCA9IGBodHRwczovL3NwcmVhZHNoZWV0cy5nb29nbGUuY29tL2ZlZWRzL2xpc3QvJHtzaGVldElkfS9kZWZhdWx0L3B1YmxpYy92YWx1ZXM/YWx0PWpzb247YFxuXG4gIHZhciBvcHRpb25zID0ge1xuICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgdXJsLFxuICAgIHFzOiB7IGFsdDogJ2pzb24nIH0sXG4gICAgaGVhZGVyczpcbiAgICB7XG4gICAgICAnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZSdcbiAgICB9LFxuICAgIGpzb246IHRydWUsXG4gIH07XG4gIHJldHVybiByZXF1ZXN0KG9wdGlvbnMpO1xufVxuXG5mdW5jdGlvbiBzaGVldHNSZXNwb25zZVRvUm93cyhyZXNwb25zZTogU2hlZXRzUmVzcG9uc2UpOiBUcmFuc2xhdGlvblJvd1tdIHtcbiAgY29uc3QgcGVyUm93VHJhbnNsYXRpb25zOiBUcmFuc2xhdGlvblJvd1tdID0gW107XG5cbiAgcmVzcG9uc2UuZmVlZC5lbnRyeS5mb3JFYWNoKChyOiBTaGVldHNSb3cpID0+IHtcbiAgICBjb25zdCByb3c6IFRyYW5zbGF0aW9uUm93ID0ge1xuICAgICAgaWQ6IHIudGl0bGUuJHQsXG4gICAgICBub3Rlczogci5nc3gkbm90ZXMuJHQsXG4gICAgICB0eXBlOiByLmdzeCR0eXBlLiR0LFxuICAgICAgZW5fQVU6IHIuZ3N4JGVuYXUuJHQsXG4gICAgICBlbl9VUzogci5nc3gkZW51cy4kdCxcbiAgICAgIGd1al9JTjogci5nc3gkZ3VqaW4uJHQsXG4gICAgICBoaV9JTjogci5nc3gkaGlpbi4kdCxcbiAgICAgIHRlc3RfVVBQRVI6IHIuZ3N4JHRlc3R1cHBlci4kdCxcbiAgICAgIGZyX0ZSOiByLmdzeCRmcmZyLiR0LFxuICAgICAgZXNfRVM6IHNhbml0aXplKHIuZ3N4JGVzZXMuJHQpLFxuXG4gICAgfTtcbiAgICBwZXJSb3dUcmFuc2xhdGlvbnMucHVzaChyb3cpO1xuICB9KTtcblxuICByZXR1cm4gcGVyUm93VHJhbnNsYXRpb25zO1xufVxuXG5mdW5jdGlvbiBzaGVldHNSZXNwb25zZVRvUm93c0dHTU4ocmVzcG9uc2U6IFNoZWV0c1Jlc3BvbnNlKTogR0dNTlRyYW5zbGF0aW9uUm93W10ge1xuICBjb25zdCBwZXJSb3dUcmFuc2xhdGlvbnM6IEdHTU5UcmFuc2xhdGlvblJvd1tdID0gW107XG5cbiAgcmVzcG9uc2UuZmVlZC5lbnRyeS5mb3JFYWNoKChyOiBTaGVldHNSb3cpID0+IHtcbiAgICBjb25zdCByb3c6IEdHTU5UcmFuc2xhdGlvblJvdyA9IHtcbiAgICAgIGlkOiByLnRpdGxlLiR0LFxuICAgICAgbm90ZXM6IHIuZ3N4JG5vdGVzLiR0LFxuICAgICAgdHlwZTogci5nc3gkdHlwZS4kdCxcbiAgICAgIGVuX0FVOiByLmdzeCRlbmF1LiR0LFxuICAgICAgZnJfRlI6IHIuZ3N4JGZyZnIuJHQsXG4gICAgICBlc19FUzogc2FuaXRpemUoci5nc3gkZXNlcy4kdCksXG5cbiAgICB9O1xuICAgIHBlclJvd1RyYW5zbGF0aW9ucy5wdXNoKHJvdyk7XG4gIH0pO1xuXG4gIHJldHVybiBwZXJSb3dUcmFuc2xhdGlvbnM7XG59XG5cblxuZnVuY3Rpb24gcnVuKCkge1xuICBnZXRTaGVldEFzSnNvbihcIjEwMnpMcUVXajR4bHFxTmdWVUZDaU1McWRjdmFMWTZHbnRTMXhtbEhkQUU4XCIpXG4gIC50aGVuKChyZXNwb25zZTogU2hlZXRzUmVzcG9uc2UpID0+IHtcbiAgICBjb25zdCBwZXJSb3dUcmFuc2xhdGlvbnMgPSBzaGVldHNSZXNwb25zZVRvUm93cyhyZXNwb25zZSk7XG5cbiAgICAvL05vdyB0aGF0IHdlIGhhdmUgdGhlIHJvd3MsIHdyaXRlIHRoZSBmaWxlcyFcbiAgICBjb25zdCBlbl9BVTogVHJhbnNsYXRpb25Db2x1bW4gPSB7fTtcbiAgICBjb25zdCBlbl9VUzogVHJhbnNsYXRpb25Db2x1bW4gPSB7fTtcbiAgICBjb25zdCBndWpfSU46IFRyYW5zbGF0aW9uQ29sdW1uID0ge307XG4gICAgY29uc3QgaGlfSU46IFRyYW5zbGF0aW9uQ29sdW1uID0ge307XG4gICAgY29uc3QgZnJfRlI6IFRyYW5zbGF0aW9uQ29sdW1uID0ge307XG4gICAgY29uc3QgZXNfRVM6IFRyYW5zbGF0aW9uQ29sdW1uID0ge307XG4gICAgY29uc3QgdGVzdF9VUFBFUjogVHJhbnNsYXRpb25Db2x1bW4gPSB7fTtcbiAgICBwZXJSb3dUcmFuc2xhdGlvbnMuZm9yRWFjaChyb3cgPT4gZW5fQVVbcm93LmlkXSA9IFtyb3cuZW5fQVUsIHJvdy50eXBlXSlcbiAgICBwZXJSb3dUcmFuc2xhdGlvbnMuZm9yRWFjaChyb3cgPT4gZW5fVVNbcm93LmlkXSA9IFtyb3cuZW5fVVMsIHJvdy50eXBlXSlcbiAgICBwZXJSb3dUcmFuc2xhdGlvbnMuZm9yRWFjaChyb3cgPT4gZ3VqX0lOW3Jvdy5pZF0gPSBbcm93Lmd1al9JTiwgcm93LnR5cGVdKVxuICAgIHBlclJvd1RyYW5zbGF0aW9ucy5mb3JFYWNoKHJvdyA9PiBoaV9JTltyb3cuaWRdID0gW3Jvdy5oaV9JTiwgcm93LnR5cGVdKVxuICAgIHBlclJvd1RyYW5zbGF0aW9ucy5mb3JFYWNoKHJvdyA9PiBmcl9GUltyb3cuaWRdID0gW3Jvdy5mcl9GUiwgcm93LnR5cGVdKVxuICAgIHBlclJvd1RyYW5zbGF0aW9ucy5mb3JFYWNoKHJvdyA9PiBlc19FU1tyb3cuaWRdID0gW3Jvdy5lc19FUywgcm93LnR5cGVdKVxuICAgIHBlclJvd1RyYW5zbGF0aW9ucy5mb3JFYWNoKHJvdyA9PiB0ZXN0X1VQUEVSW3Jvdy5pZF0gPSBbcm93LnRlc3RfVVBQRVIsIHJvdy50eXBlXSlcblxuICAgIGNvbnN0IGVuX0FVX2ZpbGUgPSBmaWxlRm9yVHJhbnNsYXRpb25zKFRyYW5zbGF0aW9uRW51bS5lbl9BVSwgZW5fQVUpO1xuICAgIGNvbnN0IGVuX1VTX2ZpbGUgPSBmaWxlRm9yVHJhbnNsYXRpb25zKFRyYW5zbGF0aW9uRW51bS5lbl9VUywgZW5fVVMpO1xuICAgIGNvbnN0IHVqX0lOX2ZpbGUgPSBmaWxlRm9yVHJhbnNsYXRpb25zKFRyYW5zbGF0aW9uRW51bS5ndWpfSU4sIGd1al9JTik7XG4gICAgY29uc3QgaGlfSU5fZmlsZSA9IGZpbGVGb3JUcmFuc2xhdGlvbnMoVHJhbnNsYXRpb25FbnVtLmhpX0lOLCBoaV9JTik7XG4gICAgY29uc3QgdGVzdF9VUFBFUl9maWxlID0gZmlsZUZvclRyYW5zbGF0aW9ucyhUcmFuc2xhdGlvbkVudW0udGVzdF9VUFBFUiwgdGVzdF9VUFBFUik7XG4gICAgY29uc3QgZnJfRlJfZmlsZSA9IGZpbGVGb3JUcmFuc2xhdGlvbnMoVHJhbnNsYXRpb25FbnVtLmZyX0ZSLCBmcl9GUik7XG4gICAgY29uc3QgZXNfRVNfZmlsZSA9IGZpbGVGb3JUcmFuc2xhdGlvbnMoVHJhbnNsYXRpb25FbnVtLmVzX0VTLCBlc19FUyk7XG5cbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1xuICAgICAgd3JpdGVGaWxlKCcuL3NyYy9jb21tb24vZW5fQVUudHMnLCBlbl9BVV9maWxlKSxcbiAgICAgIHdyaXRlRmlsZSgnLi9zcmMvY29tbW9uL2VuX1VTLnRzJywgZW5fVVNfZmlsZSksXG4gICAgICB3cml0ZUZpbGUoJy4vc3JjL2NvbW1vbi9ndWpfSU4udHMnLCB1al9JTl9maWxlKSxcbiAgICAgIHdyaXRlRmlsZSgnLi9zcmMvY29tbW9uL2hpX0lOLnRzJywgaGlfSU5fZmlsZSksXG4gICAgICB3cml0ZUZpbGUoJy4vc3JjL2NvbW1vbi90ZXN0X1VQUEVSLnRzJywgdGVzdF9VUFBFUl9maWxlKSxcbiAgICAgIHdyaXRlRmlsZSgnLi9zcmMvY29tbW9uL2ZyX0ZSLnRzJywgZnJfRlJfZmlsZSksXG4gICAgICB3cml0ZUZpbGUoJy4vc3JjL2NvbW1vbi9lc19FUy50cycsIGVzX0VTX2ZpbGUpLFxuICAgIF0pLmNhdGNoKGVyciA9PiBjb25zb2xlLmVycm9yKGVycikpXG4gIH0pXG4gIC5jYXRjaCgoZXJyOiBhbnkpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XG59XG5cbmZ1bmN0aW9uIGdldE92ZXJyaWRlcyhzaGVldElkOiBzdHJpbmcsIG9yZ0lkOiBzdHJpbmcpIHtcbiAgcmV0dXJuIGdldFNoZWV0QXNKc29uKHNoZWV0SWQpXG4gIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICBjb25zdCBwZXJSb3dUcmFuc2xhdGlvbnMgPSBzaGVldHNSZXNwb25zZVRvUm93c0dHTU4ocmVzcG9uc2UpLmZpbHRlcihyID0+IHIubm90ZXMudG9Mb3dlckNhc2UoKSA9PT0gJ292ZXJyaWRlJyk7XG4gICAgY29uc29sZS5sb2coYEZvdW5kICR7cGVyUm93VHJhbnNsYXRpb25zLmxlbmd0aH0gb3ZlcnJpZGVzIGZvciBvcmc6ICR7b3JnSWR9YCk7XG5cbiAgICAvL1RPRE86IGdlbmVyYWxpemUgdG8gb3RoZXIgb3JncywgZm9yIG5vdyBHR01OIGlzIGZpbmVcblxuICAgIC8vTm93IHRoYXQgd2UgaGF2ZSB0aGUgcm93cywgd3JpdGUgdGhlIGZpbGVzIVxuICAgIGNvbnN0IGVuX0FVOiBUcmFuc2xhdGlvbkNvbHVtbiA9IHt9O1xuICAgIGNvbnN0IGZyX0ZSOiBUcmFuc2xhdGlvbkNvbHVtbiA9IHt9O1xuICAgIGNvbnN0IGVzX0VTOiBUcmFuc2xhdGlvbkNvbHVtbiA9IHt9O1xuICAgIHBlclJvd1RyYW5zbGF0aW9ucy5mb3JFYWNoKHJvdyA9PiBlbl9BVVtyb3cuaWRdID0gW3Jvdy5lbl9BVSwgcm93LnR5cGVdKVxuICAgIHBlclJvd1RyYW5zbGF0aW9ucy5mb3JFYWNoKHJvdyA9PiBmcl9GUltyb3cuaWRdID0gW3Jvdy5mcl9GUiwgcm93LnR5cGVdKVxuICAgIHBlclJvd1RyYW5zbGF0aW9ucy5mb3JFYWNoKHJvdyA9PiBlc19FU1tyb3cuaWRdID0gW3Jvdy5lc19FUywgcm93LnR5cGVdKVxuXG4gICAgY29uc3QgZW5fQVVfZmlsZSA9IGZpbGVGb3JPdmVycmlkZXMob3JnSWQsIFRyYW5zbGF0aW9uRW51bS5lbl9BVSwgZW5fQVUpO1xuICAgIGNvbnN0IGZyX0ZSX2ZpbGUgPSBmaWxlRm9yT3ZlcnJpZGVzKG9yZ0lkLCBUcmFuc2xhdGlvbkVudW0uZnJfRlIsIGZyX0ZSKTtcbiAgICBjb25zdCBlc19FU19maWxlID0gZmlsZUZvck92ZXJyaWRlcyhvcmdJZCwgVHJhbnNsYXRpb25FbnVtLmVzX0VTLCBlc19FUyk7XG5cbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1xuICAgICAgd3JpdGVGaWxlKGAuL3NyYy8ke29yZ0lkfS9lbl9BVS50c2AsIGVuX0FVX2ZpbGUpLFxuICAgICAgd3JpdGVGaWxlKGAuL3NyYy8ke29yZ0lkfS9mcl9GUi50c2AsIGZyX0ZSX2ZpbGUpLFxuICAgICAgd3JpdGVGaWxlKGAuL3NyYy8ke29yZ0lkfS9lc19FUy50c2AsIGVzX0VTX2ZpbGUpLFxuICAgIF0pLmNhdGNoKGVyciA9PiBjb25zb2xlLmVycm9yKGVycikpXG4gIH0pO1xuXG5cbn1cblxuLy8gcnVuKCk7XG4vL2h0dHBzOi8vZG9jcy5nb29nbGUuY29tL3NwcmVhZHNoZWV0cy9kL2UvMlBBQ1gtMXZSaUNKTmljSjZsckNaWkYyT2p2dU5sWThTd2JGRnVndVFXRUdNbi1Rb2l6V2xZdE9GYVpyb3J6SlRZRVlueGtVOVNGeWJnQzN3NFBBYU8vcHViaHRtbFxuZ2V0T3ZlcnJpZGVzKCcxMUpVcU5KLWdTY1ozc2NVZTFiaTdYTVdESmduaXdTN1pZNEd1eHY1QUp0RScsICdnZ21uJyk7Il19